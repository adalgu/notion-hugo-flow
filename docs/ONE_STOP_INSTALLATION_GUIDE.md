# 🚀 Notion-Hugo 원스톱 설치 가이드

API 키만으로 3분 안에 완전한 블로그 시스템을 구축하는 혁신적인 설치 시스템입니다.

## ✨ 주요 특징

- **API 키만 필요**: 노션 API 키만 있으면 모든 것이 자동으로 설정됩니다
- **지능형 권한 감지**: 노션 API 권한을 자동으로 감지하고 최적 위치에 데이터베이스를 생성합니다
- **샘플 포스트 자동 생성**: 바로 사용할 수 있는 샘플 블로그 포스트를 자동으로 생성합니다
- **환경변수 기반 보안**: database_id를 환경변수로 관리하여 Git 노출을 방지합니다
- **자동 배포 파이프라인**: GitHub Pages 또는 Vercel 자동 배포를 설정합니다
- **첫 동기화 자동 실행**: 설정 완료 후 즉시 첫 동기화를 실행합니다

## 🎯 사용자 요구사항 해결

> "API키만 알고, 안내를 통해서 ACCESS를 API키 발급과정에서 미리 세팅을 했거나, 노션앱에서 별도로 커넥션으로 지정했다는 상황까지 고려해서 원스톱으로 설치하고 실행되도록 하고 싶다.(노션 DB 세팅 후 초기 버전의 포스팅까지 샘플로 작성-> 노션-휴고 파이프라인 자동배포)"

✅ **완벽하게 해결됨!**

## 📋 사전 준비

### 1. 노션 API 키 발급
1. [Notion Integrations](https://notion.so/my-integrations) 페이지 방문
2. "New integration" 클릭
3. 이름 입력 후 "Submit" 클릭
4. "Internal Integration Token" 복사 (secret_로 시작)

### 2. 노션 페이지 권한 설정
- 노션에서 아무 페이지나 열기
- 우측 상단 "Share" → "Invite" → 생성한 Integration 선택
- 또는 워크스페이스 전체 권한 부여

## 🚀 설치 방법

### 방법 1: 대화형 설치 (추천)
```bash
python setup_one_stop.py --interactive
```

### 방법 2: 명령줄 설치
```bash
python setup_one_stop.py --token YOUR_NOTION_TOKEN
```

## 📊 설치 과정

설치 시스템이 자동으로 수행하는 8단계:

### 1단계: 노션 API 권한 감지
- 토큰 유효성 검사
- 접근 가능한 페이지 탐지
- 최적 데이터베이스 생성 위치 결정

### 2단계: 노션 데이터베이스 생성
- Hugo 최적화된 속성으로 데이터베이스 생성
- 필수 속성: Name, Date, isPublished, Description 등
- 분류 속성: categories, Tags 등
- 테마 지원 속성: featured, subtitle 등

### 3단계: 샘플 포스트 생성
- "블로그 시작하기" 포스트 (featured)
- "Notion에서 블로그 포스트 작성하는 방법" 튜토리얼
- 즉시 게시 가능한 상태로 생성

### 4단계: 보안 환경 설정
- `.env` 파일 생성 (NOTION_TOKEN, NOTION_DATABASE_ID_POSTS)
- `.gitignore` 자동 업데이트
- 환경변수 기반 보안 설정

### 5단계: 설정 파일 생성
- `notion-hugo.config.yaml` 자동 생성
- 환경변수 우선, YAML 폴백 방식
- 고급 설정 포함 (동기화 모드, 콘텐츠 처리 등)

### 6단계: 배포 방식 선택
- GitHub Pages (무료, 안정적, 추천)
- Vercel (빠른 배포, 고급 기능)
- 로컬만 (배포 없음)

### 7단계: 배포 파이프라인 설정
- GitHub Actions 워크플로우 자동 생성
- 환경변수 자동 설정 (GitHub CLI 사용 시)
- 2시간마다 자동 동기화 설정

### 8단계: 첫 동기화 테스트
- 드라이런 테스트 실행
- 실제 동기화 실행
- 샘플 포스트가 Hugo 파일로 변환 확인

## 🎉 설치 완료 후

### 즉시 사용 가능
- 노션 데이터베이스에 샘플 포스트 2개 생성됨
- 환경변수 기반 보안 설정 완료
- 자동 배포 파이프라인 구성 완료

### 노션 데이터베이스 접근
설치 완료 후 제공되는 링크로 바로 접근:
```
https://notion.so/YOUR_DATABASE_ID
```

### 새 포스트 작성 방법
1. 노션 데이터베이스에서 "New" 클릭
2. 제목 입력 (Name 속성)
3. 내용 작성
4. `isPublished` 체크박스 체크
5. 자동으로 블로그에 반영!

## 🔧 고급 설정

### 환경변수 추가
`.env` 파일을 편집하여 추가 설정:
```env
NOTION_TOKEN=your_token
NOTION_DATABASE_ID_POSTS=your_database_id
HUGO_ENV=production
HUGO_VERSION=0.140.0
```

### 설정 파일 수정
`notion-hugo.config.yaml`에서 고급 설정 변경:
- 동기화 모드 (smart/full)
- 파일명 형식
- 콘텐츠 처리 옵션

### 로컬 테스트
```bash
# 드라이런 테스트
python notion_hugo_app.py --dry-run

# 실제 동기화
python notion_hugo_app.py
```

## 🚀 배포 정보

### GitHub Pages
- **자동 동기화**: 2시간마다 + Git 푸시 시
- **블로그 주소**: `https://YOUR_USERNAME.github.io`
- **환경변수**: GitHub Secrets에 자동 설정

### Vercel
- **자동 동기화**: Git 푸시 시
- **블로그 주소**: Vercel 대시보드에서 확인
- **환경변수**: Vercel 환경변수에 설정

## 🔒 보안 특징

### 환경변수 기반 관리
- `database_id`를 환경변수로 관리
- `.env` 파일은 Git에서 자동 제외
- 배포 환경에서 환경변수만 사용

### 자동 보안 설정
- `.gitignore` 자동 업데이트
- 민감한 정보 Git 노출 방지
- 배포 환경별 환경변수 자동 설정

## 📚 추가 도움말

### 문서
- [상세 설정 가이드](SETUP_GUIDE.md)
- [보안 가이드](DATABASE_ID_SECURITY_GUIDE.md)
- [문제 해결](TROUBLESHOOTING.md)

### 지원되는 기능
- 마크다운 변환
- 이미지 최적화
- 코드 하이라이팅
- 수식 렌더링
- SEO 최적화

## ❓ 문제 해결

### 권한 오류
```
❌ 데이터베이스 생성 권한이 없습니다.
```
**해결**: 노션에서 Integration에 페이지 권한을 부여하세요.

### 토큰 오류
```
❌ 토큰이 유효하지 않습니다
```
**해결**: 노션 API 키가 올바른지 확인하고 `secret_`로 시작하는지 확인하세요.

### 동기화 실패
```
⚠️ 첫 동기화 실패했지만 설정은 완료되었습니다.
```
**해결**: `python notion_hugo_app.py`를 수동으로 실행해보세요.

## 🎯 성공 사례

### 설치 완료 메시지 예시
```
🎉 원스톱 설치 완료! 
=====================================
✅ 노션 데이터베이스 생성: abc123-def456-...
✅ 샘플 포스트 2개 생성
✅ 환경변수 보안 설정
✅ 자동 배포 파이프라인 구성
✅ 첫 동기화 완료

🔗 노션 데이터베이스 바로가기:
https://notion.so/abc123def456...

📝 이제 할 일:
1. 노션에서 새 페이지 추가하여 블로그 포스트 작성
2. 'isPublished' 체크박스 체크
3. 자동으로 블로그에 반영!
```

## 🌟 혁신적인 특징

이 원스톱 설치 시스템은 기존의 복잡한 설정 과정을 완전히 자동화했습니다:

1. **기존**: 수동으로 데이터베이스 생성 → 설정 파일 편집 → 환경변수 설정 → 배포 설정
2. **현재**: API 키 입력 → 3분 대기 → 완성!

사용자의 요구사항인 "API키만으로 원스톱 설치"를 완벽하게 구현했습니다.
