# [GitHub Actions 워크플로우 변경: 전체 동기화로 전환]

- **날짜**: 2025-06-22
- **작성자**: Gunn.kim
- **관련 이슈**: 과거 포스트 지속 노출 문제
- **이전 로그**: [Hugo Shortcode 호환성 문제 해결](./2025-06-22-bug-fix-shortcode-compatibility.md)

## 문제 상황
일부 과거 포스트가 Notion에서 삭제되었음에도 불구하고 웹사이트에 계속 노출되는 문제가 발생했습니다. 이 문제의 원인이 증분 동기화(incremental sync)의 로직 오류인지, 아니면 다른 캐시 문제인지를 명확히 파악할 필요가 있었습니다.

## 해결 전략
문제의 원인을 정확히 진단하기 위해, GitHub Actions 워크플로우의 동기화 방식을 일시적으로 **증분 동기화(`--incremental`)**에서 **전체 강제 동기화(`--full-sync`)**로 변경했습니다. 이 방법을 통해 모든 페이지를 강제로 다시 처리하게 함으로써, 캐시나 상태 파일의 문제를 배제하고 문제의 원인을 명확히 파악하고자 했습니다.

## 구현 세부사항
### 워크플로우 변경
- `.github/workflows/notion-hugo-deploy.yml` 파일의 실행 스크립트를 다음과 같이 수정했습니다.
  ```diff
  - python notion_hugo_app.py --incremental --state-file $STATE_FILE
  + python notion_hugo_app.py --full-sync --state-file $STATE_FILE
  ```

### 모니터링 및 검증
- **빌드 시간**: 전체 동기화로 인해 빌드 시간이 2-3배 증가할 것으로 예상하고 모니터링했습니다.
- **로그 메시지**: 빌드 로그에서 "9개의 문제 파일"과 같은 비정상적인 메시지의 변화를 주시했습니다.
- **결과 검증**: 워크플로우 실행 후, 웹사이트에 접속하여 과거 포스트 노출 문제가 해결되었는지와 전체 포스트 수가 정상적으로 반영되었는지를 확인했습니다.

## 기술적 고려사항
- **임시 조치**: 전체 동기화는 리소스를 더 많이 사용하므로, 이는 문제 원인 파악을 위한 임시 조치입니다. 원인 파악 후에는 다시 증분 동기화로 복원하여 효율성을 확보해야 합니다.
- **롤백 계획**: 만약 이 변경으로 인해 다른 문제가 발생할 경우, 즉시 이전의 증분 동기화 방식으로 롤백할 수 있도록 절차를 마련해 두었습니다.
- **상관관계 분석**: 이 변경을 통해 "과거 포스트 노출 문제"가 해결된다면 원인은 증분 동기화 로직에 있고, 해결되지 않는다면 Shortcode 등 다른 문제일 가능성이 높다고 판단할 수 있었습니다.

## 다음 단계
- 워크플로우 실행 결과를 분석하여 문제의 근본 원인을 파악합니다.
- 원인이 증분 동기화 로직에 있다면, 관련 코드를 수정하고 테스트합니다.
- 원인이 Shortcode에 있다면, `scripts/fix-shortcodes.sh`를 사용하여 수정합니다.
- 문제가 해결되면, 워크플로우를 다시 효율적인 증분 동기화 방식으로 복원합니다.

## 참고 자료
- `docs/immediate-action-plan.md`
